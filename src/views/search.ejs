<% include layouts/header %>

<div class="container-fluid bg-2" >
        <div class="row center-top">
            <div class="col-md-12">
                    <h1 class="heading " style="text-transform: uppercase;">
                        <span class="">
                             Results for :  
                        </span>
                        <%= searchQuery %>
                    </h1>
                    <div class="row" id="loop">

                    </div>
                    <div class="row" id="dummy-t">

                            <div class="col-md-3">
                               <div class="product-details">
                                   <div class="dummy container"></div>
                                   <div class="dummy line"></div>
                                   <div class="dummy line"></div>
                               </div>
                           </div>
                           <div class="col-md-3">
                               <div class="product-details">
                                   <div class="dummy container"></div>
                                   <div class="dummy line"></div>
                                   <div class="dummy line"></div>
                               </div>
                           </div>
                           <div class="col-md-3">
                               <div class="product-details">
                                   <div class="dummy container"></div>
                                   <div class="dummy line"></div>
                                   <div class="dummy line"></div>
                               </div>
                           </div>
                           <div class="col-md-3">
                               <div class="product-details">
                                   <div class="dummy container"></div>
                                   <div class="dummy line"></div>
                                   <div class="dummy line"></div>
                               </div>
                           </div>
                       </div>
            </div>
        </div>
</div>
<script>

    $(window).load((e) => {
         window.count = 0;

         searchFetch();

    })


    $(window).scroll((e) => {

        if($(window).scrollTop() >= $(document).height() - $(window).height() - 10){
            console.log("fetching" )
            searchFetch();
        }

    })
      function searchFetch(){
            const searchQuery = '<%= searchQuery %>';
             count = count  + 4;
            console.log(count);
   
                 $.ajax({
                 url:"/search/fetch/"+searchQuery +"/"+count,
                 type:"post",
                 dataType:"text",
                 success : (res)=>{
                    
                    $("#loop").append(res);

                 }
                 })
            

    }



</script>



<% include layouts/footer %>